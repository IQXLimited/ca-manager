<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-T"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>CA Manager</title>
    <link href="style.css" rel="stylesheet"/>
</head>
<body>
<div class="container">
    <h1>CA Manager</h1>

    <details id="create-ca-details">
        <summary>Create New Certificate Authority</summary>
        <div class="card card-inset">
            <div class="form-grid">
                <input id="ca-country" placeholder="Country (GB)" type="text">
                <input id="ca-state" placeholder="State (The Scottish Borders)" type="text">
                <input id="ca-locality" placeholder="Locality (Melrose)" type="text">
                <input id="ca-org" placeholder="Organization (IQX Limited)" type="text">
                <input id="ca-common" class="full-width" placeholder="* Common Name (e.g. IQX Limited)" type="text">
            </div>
            <label for="ca-expiry">Expiry in Years:</label>
            <select id="ca-expiry" class="full-width"></select>
            <button id="btn-create-ca">Create New CA</button>
        </div>
    </details>

    <div class="card">
        <h2>Create Device Certificate</h2>
        <label for="ca-selector-device">Sign with CA:</label>
        <div class="select-with-button">
            <select id="ca-selector-device"></select>
            <button class="btn-delete" id="btn-delete-ca-device" title="Delete selected CA">X</button>
        </div>
        
        <label for="cert-cn">Common Name (CN):</label>
        <input id="cert-cn" placeholder="e.g., my-server, *.my-domain.local, or 192.168.1.50" type="text">

        <label for="cert-sans-input">Additional Names (SANs):</label>
        <div class="sans-container" id="sans-container">
            <!-- Pills will be added here by JavaScript -->
            <input id="cert-sans-input" placeholder="Type a name and press Enter, Tab, or Comma..." type="text">
        </div>

        <label for="device-expiry">Expiry in Years:</label>
        <select id="device-expiry"></select>
        <button id="btn-create-cert">Create Certificate</button>
    </div>
    
    <div class="card" id="install-ca-section">
        <h2>Install CA in Windows</h2>
        <label for="ca-selector-install">Select CA to Install:</label>
        <div class="select-with-button">
            <select id="ca-selector-install"></select>
             <button class="btn-delete" id="btn-delete-ca-install" title="Delete selected CA">X</button>
        </div>
        <button id="btn-install-ca">Install Selected CA (Admin)</button>
        <button id="btn-generate-installer" class="btn-secondary">Generate Installer</button>
    </div>

    <div class="card">
        <h2>Generated Device Certificates</h2>
        <ul id="cert-list">
            <li>No certificates found.</li>
        </ul>
        <div class="card-footer">
            <button id="btn-refresh-certs" class="btn-secondary">Refresh List</button>
            <button id="btn-open-output" class="btn-secondary">Open Output Directory</button>
        </div>
    </div>

    <details class="log-details">
        <summary>Show Log</summary>
        <div class="log-container">
            <pre id="log-output">Welcome! Actions will be logged here.</pre>
        </div>
    </details>

    <footer id="app-footer">
        <!-- Copyright will be inserted by JavaScript -->
    </footer>
</div>

<div id="toast-container"></div>

<!-- Modal for inspecting certificate -->
<div id="inspect-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <span class="modal-close" id="modal-close-btn">&times;</span>
        <h3>Certificate Details</h3>
        <div id="modal-body">
            <!-- Details will be populated by JavaScript -->
        </div>
    </div>
</div>


<script src="main.js"></script>
</body>
</html>
